version: "3.5"

services:
    keycloak:
        image: mocap/keycloak
        container_name: mocap-keycloak
        build:
            context: ./
            dockerfile: Dockerfile
        env_file:
            - .env.production
            - .env.production.local
        networks:
            - mocap
        ports:
            - 8888:8080 # web ui
        restart: always
        command: start-dev --import-realm --hostname-url=$${KEYCLOAK_HOST_URL}
        # Should have used this command instead but certificate is not set up yet
        # command: "start --import-realm --hostname-url=$${KEYCLOAK_HOST_URL}"
networks:
    mocap:
        external: true
